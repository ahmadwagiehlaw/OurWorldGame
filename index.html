<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¹Ø§Ù„Ù…Ù†Ø§ Ø§Ù„Ø®Ø§Øµ</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#fff0f5">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #fff0f5 0%, #ffe4e1 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --primary: #d63384;
            --primary-soft: #ff8fa3;
            --text-main: #4a4a4a;
            --text-light: #777;
            --gold: #c5a059;
            --success: #4CAF50;
            --danger: #f44336;
            --shadow: 0 10px 30px rgba(214, 51, 132, 0.15);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        
        body {
            background: var(--bg-gradient);
            color: var(--text-main);
            font-family: 'Cairo', sans-serif;
            margin: 0; padding: 0; overflow-x: hidden;
            display: flex; flex-direction: column; min-height: 100vh;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            backdrop-filter: blur(10px);
            position: sticky; top: 0; z-index: 100;
            border-bottom-left-radius: 20px; border-bottom-right-radius: 20px;
        }

        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        
        h1 { 
            margin: 0; font-family: 'Dancing Script', cursive; font-size: 1.8rem; 
            background: linear-gradient(to right, #d63384, #c5a059);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        /* Scoreboard */
        .scoreboard {
            display: flex; justify-content: space-between; align-items: center;
            background: white; padding: 10px 20px; border-radius: 50px;
            box-shadow: var(--shadow); margin-top: 5px;
        }
        .score-box { 
            text-align: center; width: 40%; position: relative; transition: 0.3s; 
            padding: 5px; border-radius: 15px;
        }
        
        /* Turn Indicator */
        .score-box.active-turn::after {
            content: 'Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„ÙŠÙƒ'; position: absolute; bottom: -18px; left: 50%; transform: translateX(-50%);
            font-size: 0.7rem; background: var(--primary); color: white; padding: 2px 8px; border-radius: 10px;
            white-space: nowrap; animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .score-box.active-turn .score-val { color: var(--primary); transform: scale(1.1); }
        .score-val { font-size: 1.4rem; font-weight: 800; color: #ccc; transition: 0.3s; }
        .score-label { font-size: 0.8rem; color: var(--text-light); font-weight: bold; }

        /* Safe Mode Switch */
        .safe-switch { position: relative; width: 46px; height: 24px; }
        .safe-switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc; transition: .4s; border-radius: 34px;
        }
        .slider:before {
            position: absolute; content: "ğŸ¤"; display:flex; justify-content:center; align-items:center; 
            font-size: 10px; height: 18px; width: 18px; left: 3px; bottom: 3px;
            background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        input:checked + .slider { background-color: var(--primary-soft); }
        input:checked + .slider:before { transform: translateX(22px); content: "ğŸ”¥"; }

        /* Main Content */
        main { flex: 1; padding: 20px; padding-bottom: 90px; text-align: center; overflow-y: auto; }
        .module { display: none; animation: fadeIn 0.6s ease-out; }
        .module.active { display: block; }

        /* Wheel */
        .wheel-container {
            position: relative; width: 280px; height: 280px; margin: 30px auto;
            border-radius: 50%; border: 8px solid white; 
            box-shadow: 0 0 0 4px var(--primary-soft), var(--shadow);
            overflow: hidden; transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
        }
        .wheel-arrow {
            position: absolute; top: -20px; left: 50%; transform: translateX(-50%);
            z-index: 10; width: 40px; height: 40px; background: white;
            clip-path: polygon(50% 100%, 0 0, 100% 0);
            filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1));
        }
        .wheel-inner { width: 100%; height: 100%; background: conic-gradient(from 0deg, #ffdde1 0%, #ee9ca7 100%); border-radius: 50%; }

        /* Cards */
        .level-selector { display: flex; gap: 8px; justify-content: center; margin-bottom: 25px; }
        .lvl-btn {
            padding: 8px 16px; background: white; border: none;
            color: var(--text-light); border-radius: 20px; font-size: 0.85rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); transition: 0.3s;
        }
        .lvl-btn.active { background: var(--primary); color: white; font-weight: bold; box-shadow: 0 5px 15px rgba(214, 51, 132, 0.4); }
        .lvl-btn.locked { opacity: 0.6; background: #eee; }

        .card-display {
            background: white; border-radius: 25px; padding: 40px 25px; min-height: 280px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            margin: 10px 0; box-shadow: var(--shadow); position: relative; overflow: hidden;
        }
        .card-display::before {
            content: 'â¤ï¸'; position: absolute; font-size: 10rem; opacity: 0.05; color: var(--primary); z-index: 0;
        }
        .card-text { font-size: 1.2rem; line-height: 1.7; color: #333; z-index: 1; font-weight: 600; }
        .card-type { color: var(--primary); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 15px; z-index: 1;}

        /* Confirmation Buttons */
        .confirm-area { display: none; gap: 15px; margin-top: 20px; width: 100%; justify-content: center; animation: slideUp 0.3s; }
        .confirm-btn {
            border: none; padding: 12px 25px; border-radius: 15px; font-weight: bold; color: white; cursor: pointer; flex: 1; max-width: 140px;
            display: flex; align-items: center; justify-content: center; gap: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .btn-yes { background: var(--success); }
        .btn-no { background: var(--danger); }

        /* Dice */
        .dice-area { display: flex; justify-content: center; gap: 20px; margin: 50px 0; }
        .die {
            width: 110px; height: 110px; background: white; border-radius: 20px;
            display: flex; justify-content: center; align-items: center;
            font-size: 1.1rem; font-weight: bold; color: var(--primary);
            box-shadow: var(--shadow); border: 2px solid #fff0f5;
        }

        /* Buttons */
        .action-btn {
            background: linear-gradient(45deg, var(--primary), #ff8fa3);
            color: white; border: none; padding: 16px 45px; border-radius: 50px;
            font-size: 1.1rem; font-weight: bold; cursor: pointer;
            box-shadow: 0 10px 25px rgba(214, 51, 132, 0.4);
            margin-top: 25px; width: 85%; transition: transform 0.2s;
        }
        .action-btn:active { transform: scale(0.96); }
        .action-btn:disabled { opacity: 0.5; filter: grayscale(1); cursor: not-allowed; }
        
        .action-row { display: flex; gap: 15px; width: 90%; margin: 20px auto 0; }
        .action-row .action-btn { width: 50%; margin-top: 0; font-size: 1rem; }

        .joker-btn {
            background: white; color: var(--gold); border: 2px solid var(--gold);
            padding: 8px 20px; border-radius: 20px; font-size: 0.9rem; margin-top: 20px;
            font-weight: bold;
        }

        /* Nav */
        nav {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            background: white; border-radius: 25px; padding: 15px;
            display: flex; justify-content: space-around;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1); z-index: 99;
        }
        .nav-btn {
            background: none; border: none; color: #ccc; font-size: 1.5rem;
            transition: 0.3s; position: relative;
        }
        .nav-btn.active { color: var(--primary); transform: translateY(-5px); }
        .nav-btn.active::after {
            content: ''; position: absolute; bottom: -5px; left: 50%; transform: translateX(-50%);
            width: 5px; height: 5px; background: var(--primary); border-radius: 50%;
        }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
            z-index: 1000; display: none; justify-content: center; align-items: center;
        }
        .modal-content {
            background: white; width: 90%; max-height: 80vh; overflow-y: auto;
            border-radius: 25px; padding: 25px; text-align: right;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2); animation: slideUp 0.4s;
        }
        .rule-block { margin-bottom: 15px; border-bottom: 1px solid #f0f0f0; padding-bottom: 10px;}
        .rule-title { font-weight: bold; color: var(--primary); margin-bottom: 5px; }
        .close-btn { background: #eee; border: none; width: 30px; height: 30px; border-radius: 50%; font-weight: bold; cursor: pointer; float: left; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes popIn { from { transform: translateX(-50%) scale(0); } to { transform: translateX(-50%) scale(1); } }
        .shake { animation: shake 0.5s; }
        @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-5px) rotate(-5deg);} 75% {transform: translateX(5px) rotate(5deg);} }

    </style>
</head>
<body>

    <header>
        <div class="top-bar">
            <h1 style="font-size:1.5rem">Our Private World</h1>
            <div style="display:flex; gap:10px; align-items:center;">
                <label class="safe-switch">
                    <input type="checkbox" id="modeToggle" onchange="toggleMode()">
                    <span class="slider"></span>
                </label>
                <button onclick="openHelp()" style="background:none; border:none; font-size:1.5rem;">â„¹ï¸</button>
            </div>
        </div>
        
        <div class="scoreboard">
            <div class="score-box active-turn" id="box-p1">
                <div class="score-val" id="score1">0</div>
                <div class="score-label">AHMED</div>
            </div>
            <div style="font-size: 1.2rem; color: #ddd;">vs</div>
            <div class="score-box" id="box-p2">
                <div class="score-val" id="score2">0</div>
                <div class="score-label">LULU</div>
            </div>
        </div>
        <div id="reward-msg" style="text-align:center; color: var(--gold); font-size: 0.8rem; margin-top:5px; min-height: 20px; font-weight:600;"></div>
    </header>

    <main>
        <div id="mod-wheel" class="module active">
            <h2>Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸</h2>
            <p style="font-size:0.9rem; color:#777;">Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„Ù‰: <span class="cp-name" style="color:var(--primary); font-weight:bold;">Ø£Ø­Ù…Ø¯</span></p>
            
            <div class="wheel-container" id="wheel">
                <div class="wheel-arrow"></div>
                <div class="wheel-inner">
                    <div style="display:flex; height:100%; justify-content:center; align-items:center;">
                        <span style="font-size:4rem; filter: grayscale(100%) brightness(200%);">ğŸŒ¸</span>
                    </div>
                </div>
            </div>
            
            <div id="wheel-result" style="min-height: 50px; font-size: 1.1rem; color: var(--primary); margin: 15px 0; font-weight:bold;">
                Ø¬Ø§Ù‡Ø²ÙŠÙ†ØŸ
            </div>
            
            <div id="wheel-actions" class="confirm-area">
                <button class="confirm-btn btn-yes" onclick="confirmAction(true, 10)">âœ… Ù†ÙØ°Øª (+10)</button>
                <button class="confirm-btn btn-no" onclick="confirmAction(false, 0)">âŒ Ø§Ù†Ø³Ø­Ø§Ø¨</button>
            </div>

            <button class="action-btn" id="spin-btn" onclick="spinWheel()">ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¹Ø¬Ù„Ø©</button>
        </div>

        <div id="mod-cards" class="module">
            <h2>ÙƒØ±ÙˆØª Ø§Ù„ØµØ±Ø§Ø­Ø© ÙˆØ§Ù„Ø¬Ø±Ø£Ø©</h2>
            
            <div class="level-selector">
                <button class="lvl-btn active" id="lvl1-btn" onclick="setLevel(1)">Ø§Ù„Ø¯Ø§ÙØ¦</button>
                <button class="lvl-btn locked" id="lvl2-btn" onclick="setLevel(2)">Ø§Ù„Ø³Ø§Ø®Ù†</button>
                <button class="lvl-btn locked" id="lvl3-btn" onclick="setLevel(3)">Ø§Ù„Ø¹Ù…ÙŠÙ‚</button>
            </div>
            
            <div class="card-display">
                <div class="card-type" id="card-type">Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠ: <span class="cp-name">Ø£Ø­Ù…Ø¯</span></div>
                <div class="card-text" id="card-text">Ø§Ø¶ØºØ· ØªØ­Øª Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒØ§Ø±Øª</div>
                
                <div id="card-actions" class="confirm-area" style="margin-top: 20px;">
                    <button class="confirm-btn btn-yes" onclick="confirmAction(true, 'card')">âœ… ØªÙ… (+<span id="pts-val">15</span>)</button>
                    <button class="confirm-btn btn-no" onclick="confirmAction(false, 0)">âŒ Ù…Ø´ Ù‚Ø§Ø¯Ø±</button>
                </div>
            </div>

            <div class="action-row" id="card-draw-btns">
                <button class="action-btn" style="background:linear-gradient(45deg, #a8e6cf, #1de9b6); color:#004d40;" onclick="drawCard('truth')">ØµØ±Ø§Ø­Ø©</button>
                <button class="action-btn" onclick="drawCard('dare')">Ø¬Ø±Ø£Ø©</button>
            </div>
            <button class="joker-btn" id="joker-btn" onclick="useJoker()">ğŸƒ Ø§Ù„Ø¬ÙˆÙƒØ± (ØªØºÙŠÙŠØ± Ø§Ù„Ø­ÙƒÙ…)</button>
        </div>

        <div id="mod-dice" class="module">
            <h2>Ù†Ø±Ø¯ Ø§Ù„Ø­ÙˆØ§Ø³</h2>
            
            <div class="dice-area">
                <div id="die-action" class="die">ÙØ¹Ù„</div>
                <div id="die-body" class="die">Ù…ÙƒØ§Ù†</div>
            </div>
            
            <div id="dice-actions" class="confirm-area">
                <button class="confirm-btn btn-yes" onclick="confirmAction(true, 10)">âœ… Ù†ÙØ°Øª (+10)</button>
                <button class="confirm-btn btn-no" onclick="confirmAction(false, 0)">âŒ Ø§Ù†Ø³Ø­Ø§Ø¨</button>
            </div>

            <button class="action-btn" id="dice-btn" onclick="rollDice()">Ø§Ø±Ù…ÙŠ Ø§Ù„Ù†Ø±Ø¯</button>
        </div>
    </main>

    <nav>
        <button class="nav-btn active" onclick="switchTab('wheel', this)">ğŸ¡</button>
        <button class="nav-btn" onclick="switchTab('cards', this)">ğŸ’Œ</button>
        <button class="nav-btn" onclick="switchTab('dice', this)">ğŸ²</button>
    </nav>

    <div class="modal-overlay" id="helpModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeHelp()">âœ•</button>
            <h3 style="color:var(--primary); margin-top:0;">ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨</h3>
            
            <div class="rule-block">
                <div class="rule-title">1. Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„Ù†Ù‚Ø§Ø·</div>
                <div>Ø§Ù„Ù†Ù‚Ø§Ø· Ù„Ø§ ØªØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹! Ø¨Ø¹Ø¯ Ø³Ø­Ø¨ Ø§Ù„ÙƒØ§Ø±Øª Ø£Ùˆ ØªÙ†ÙÙŠØ° Ø§Ù„Ø­ÙƒÙ…ØŒ ÙŠØ¬Ø¨ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± <b>"âœ… Ù†ÙØ°Øª"</b> Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆØ§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø¯ÙˆØ±.</div>
            </div>
             <div class="rule-block">
                <div class="rule-title">2. Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù…Ø®ØµØµØ©</div>
                <div>Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ¹Ø±Ù Ù…Ù† Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø¯ÙˆØ±. Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„Ù‰ "Ø£Ø­Ù…Ø¯"ØŒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø³ØªÙƒÙˆÙ† Ù…ÙˆØ¬Ù‡Ø© Ù„Ù‡ (ÙƒØ±Ø¬Ù„)ØŒ ÙˆØ§Ù„Ø¹ÙƒØ³ Ù„Ù€ "Ù„ÙˆÙ„Ùˆ".</div>
            </div>
            <div class="rule-block">
                <div class="rule-title">3. Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª</div>
                <div>- Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1 (Ø¯Ø§ÙØ¦): 15 Ù†Ù‚Ø·Ø© Ù„Ù„ÙƒØ§Ø±Øª.<br>- Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2 (Ø³Ø§Ø®Ù†): 30 Ù†Ù‚Ø·Ø© (ÙŠÙØªØ­ Ø¹Ù†Ø¯ 50 Ù†Ù‚Ø·Ø©).<br>- Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3 (Ø¹Ù…ÙŠÙ‚): 50 Ù†Ù‚Ø·Ø© (ÙŠÙØªØ­ Ø¹Ù†Ø¯ 150 Ù†Ù‚Ø·Ø©).</div>
            </div>
        </div>
    </div>

    <script>
        // --- GENDER SPECIFIC DATA BANK ---
        const data = {
            wheel: {
                male: [ // Ahmed performs these or answers these
                    {t: "Ø¨ÙˆØ³Ø© Ø±Ù‚ÙŠÙ‚Ø© Ø¹Ù„Ù‰ Ø¬Ø¨ÙŠÙ†Ù‡Ø§", safe: true}, {t: "Ù‚ÙˆÙ„ 3 ØµÙØ§Øª Ø¨ØªØ­Ø¨Ù‡Ø§ ÙÙŠÙ‡Ø§", safe: true}, {t: "Ø´ÙŠÙ„ Ù„ÙˆÙ„Ùˆ Ù„Ù…Ø¯Ø© 10 Ø«ÙˆØ§Ù†ÙŠ", safe: true},
                    {t: "Ù…Ø³Ø§Ø¬ Ù„Ø±Ø¬Ù„ÙŠÙ‡Ø§ Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†", safe: true}, {t: "Ø­Ø¶Ù† Ù…Ù† Ø§Ù„Ø¶Ù‡Ø±", safe: true}, {t: "Ø¨ÙˆØ³ Ø¥ÙŠØ¯ÙŠÙ‡Ø§ Ø§Ù„Ø§ØªÙ†ÙŠÙ†", safe: true},
                    {t: "Ù†Ø¸Ø±Ø© Ø¹ÙŠÙ† ÙÙŠ Ø¹ÙŠÙ† ØµØ§Ù…ØªØ©", safe: true}, {t: "Ø§Ø¹Ù…Ù„Ù‡Ø§ Ù…Ø´Ø±ÙˆØ¨ Ø¨ØªØ­Ø¨Ù‡", safe: true}, {t: "ØºÙ…Ø¶ Ø¹ÙŠÙ†Ùƒ ÙˆØ®Ù„ÙŠÙ‡Ø§ ØªØ£ÙƒÙ„Ùƒ", safe: true},
                    {t: "Ø§Ø±Ø¨Ø· Ø¹ÙŠÙ†Ùƒ ÙˆØ®Ù„ÙŠÙ‡Ø§ ØªÙ„Ù…Ø³Ùƒ", safe: false}, {t: "Ø¨ÙˆØ³ Ø±Ù‚Ø¨ØªÙ‡Ø§", safe: false}, {t: "Ø±ÙƒØ¹ Ù‚Ø¯Ø§Ù…Ù‡Ø§ ÙˆØ¨ÙˆØ³ Ø¥ÙŠØ¯Ù‡Ø§", safe: false},
                    {t: "Ø®Ù„ÙŠÙ‡Ø§ ØªØ®ØªØ§Ø± Ù‚Ø·Ø¹Ø© Ù…Ù„Ø§Ø¨Ø³ ØªØ®Ù„Ø¹Ù‡Ø§", safe: false}, {t: "Ø¬Ù…ÙˆØ¯ ØªØ§Ù… ÙˆÙ‡ÙŠ ØªÙ„Ù…Ø³Ùƒ", safe: false}
                ],
                female: [ // Lulu performs these or answers these
                    {t: "Ø¨ÙˆØ³Ø© Ø¹Ù„Ù‰ Ø®Ø¯Ù‡", safe: true}, {t: "Ø§Ù„Ø¹Ø¨ÙŠÙ„Ù‡ ÙÙŠ Ø´Ø¹Ø±Ù‡", safe: true}, {t: "Ù‚ÙˆÙ„ÙŠ ØµÙØ© Ø±Ø¬ÙˆÙ„Ø© Ø¨ØªØ­Ø¨ÙŠÙ‡Ø§ ÙÙŠÙ‡", safe: true},
                    {t: "Ø§Ù‚Ø¹Ø¯ÙŠ Ø¹Ù„Ù‰ Ø±Ø¬Ù„Ù‡ Ø¯Ù‚ÙŠÙ‚Ø©", safe: true}, {t: "Ø­Ø¶Ù† Ù‚ÙˆÙŠ Ù„Ù…Ø¯Ø© Ø¯Ù‚ÙŠÙ‚Ø©", safe: true}, {t: "ØµÙˆØ±Ø© Ø³ÙŠÙ„ÙÙŠ ÙˆØ§Ù†ØªÙŠ Ø¨ØªØ¨ÙˆØ³ÙŠÙ‡", safe: true},
                    {t: "Ø§ÙƒÙ„ÙŠ Ø­ØªØ© ÙØ§ÙƒÙ‡Ø© Ù…Ù† Ø§ÙŠØ¯Ùƒ", safe: true}, {t: "Ù‡Ù…Ø³Ø© ÙÙŠ ÙˆØ¯Ù†Ù‡ Ø¨ÙƒÙ„Ù…Ø© Ø­Ù„ÙˆØ©", safe: true}, {t: "Ø¯Ù„Ø¹ÙŠÙ‡ Ø¨ØµÙˆØª ÙˆØ§Ø·ÙŠ", safe: true},
                    {t: "Ø§Ø±Ù‚ØµÙŠ Ø³Ù„Ùˆ Ù…Ø¹Ø§Ù‡", safe: true}, {t: "Ø¨ÙˆØ³Ø© Ø¹Ù„Ù‰ Ø±Ù‚Ø¨ØªÙ‡", safe: false}, {t: "Ø§Ù‚Ø¹Ø¯ÙŠ Ø¹Ù„Ù‰ Ø±Ø¬Ù„Ù‡ (ÙˆØ´ Ù„ÙˆØ´)", safe: false},
                    {t: "ØºÙ…ÙŠ Ø¹ÙŠÙ†Ùƒ ÙˆØ³Ù„Ù…ÙŠÙ‡ Ù†ÙØ³Ùƒ", safe: false}, {t: "Ø¹Ø¶Ø© Ø®ÙÙŠÙØ© ÙÙŠ Ø´ÙØªÙ‡", safe: false}
                ]
            },
            lvl1: {
                truth: {
                    male: ["Ø¥ÙŠÙ‡ Ø£ÙƒØªØ± ÙØ³ØªØ§Ù† Ù„ÙˆÙ„Ùˆ Ø¨ØªÙ„Ø¨Ø³Ù‡ ÙˆØ¨ÙŠØ®Ø·Ù Ù‚Ù„Ø¨ÙƒØŸ", "Ø£ÙˆÙ„ Ù…Ø±Ø© Ø´ÙˆÙØªÙ‡Ø§ØŒ Ø¥ÙŠÙ‡ Ø£ÙˆÙ„ Ø­Ø§Ø¬Ø© Ù„ÙØªØª Ù†Ø¸Ø±ÙƒØŸ", "Ø¥ÙŠÙ‡ Ø§Ù„Ø£ÙƒÙ„Ø© Ø§Ù„Ù„ÙŠ Ø¨ØªØ·Ø¨Ø®Ù‡Ø§ ÙˆØ¨ØªØ­Ø¨Ù‡Ø§ Ø£ÙˆÙŠØŸ", "Ù…ÙˆÙ‚Ù Ù‡ÙŠ Ø¹Ù…Ù„ØªÙ‡ ÙˆØ­Ø³ÙŠØª ÙÙŠÙ‡Ø§ Ø¨Ø­Ù†ÙŠØªÙ‡Ø§ØŸ"],
                    female: ["Ø¥ÙŠÙ‡ Ø£ÙƒØªØ± Ø­Ø§Ø¬Ø© ÙÙŠ Ø¬Ø³Ù… Ø£Ø­Ù…Ø¯ Ø¨ØªØ­Ø³Ø³Ùƒ Ø¨Ø§Ù„Ø£Ù…Ø§Ù†ØŸ", "Ø¥Ù…ØªÙ‰ Ø¨ØªØ­Ø³ÙŠ Ø¥Ù†Ù‡ Ø³Ù†Ø¯Ùƒ Ø¨Ø¬Ø¯ØŸ", "Ù„Ø¨Ø³ Ø¨ÙŠØ¹Ø¬Ø¨Ùƒ Ø¹Ù„ÙŠÙ‡ Ø£ÙˆÙŠØŸ", "Ù…ÙˆÙ‚Ù Ø­Ø³ÙŠØªÙŠ ÙÙŠÙ‡ Ø¨ØºÙŠØ±Ù‡ Ø¹Ù„ÙŠÙ‡ØŸ"]
                },
                dare: {
                    male: ["Ø´ÙŠÙ„Ù‡Ø§ ÙˆÙ„Ù Ø¨ÙŠÙ‡Ø§ Ø§Ù„Ø£ÙˆØ¶Ø©.", "Ø¨ÙˆØ³ Ø¨Ø·Ù† Ø§ÙŠØ¯Ù‡Ø§ Ø¨ØªÙ‚Ø¯ÙŠØ±.", "Ø³Ø±Ø­Ù„Ù‡Ø§ Ø´Ø¹Ø±Ù‡Ø§ Ù„Ù…Ø¯Ø© Ø¯Ù‚ÙŠÙ‚Ø©.", "ØºÙ†ÙŠ Ù…Ù‚Ø·Ø¹ Ø§ØºÙ†ÙŠØ© Ù„ÙŠÙ‡Ø§.", "Ø£ÙƒÙ„Ù‡Ø§ Ø¨Ø¥ÙŠØ¯Ùƒ."],
                    female: ["Ø§Ù‚Ø¹Ø¯ÙŠ ÙÙŠ Ø­Ø¶Ù†Ù‡ Ø¯Ù‚ÙŠÙ‚Ø©.", "Ø§Ø¹Ù…Ù„ÙŠÙ„Ù‡ Ù…Ø³Ø§Ø¬ Ù„Ù„Ø±Ø§Ø³.", "Ø¨ÙˆØ³ÙŠÙ‡ Ø¨ÙˆØ³Ø© Ø³Ø±ÙŠØ¹Ø© ÙˆØ§Ø¬Ø±ÙŠ.", "Ù‡Ù…Ø³ÙŠ ÙÙŠ ÙˆØ¯Ù†Ù‡ 'Ø¨Ø­Ø¨Ùƒ' ØªÙ„Ø§Øª Ù…Ø±Ø§Øª.", "Ø±Ù‚ØµØ© Ù‡Ø§Ø¯ÙŠØ© Ù…Ø¹Ø§Ù‡."]
                }
            },
            lvl2: {
                truth: {
                    male: ["Ø¥ÙŠÙ‡ Ø£ÙƒØªØ± Ù…Ù†Ø·Ù‚Ø© ÙÙŠ Ø¬Ø³Ù…Ù‡Ø§ Ø¨ØªØ¶Ø¹ÙÙƒØŸ", "Ø¨ØªØ­Ø¨ ØªØ´ÙˆÙÙ‡Ø§ Ø¨Ø´Ø¹Ø± Ù…ÙØ±ÙˆØ¯ ÙˆÙ„Ø§ Ù…Ù„Ù…ÙˆÙ…ØŸ", "Ø¥ÙŠÙ‡ Ù„ÙˆÙ† Ø§Ù„Ù„Ø§Ù†Ø¬Ø±ÙŠ Ø§Ù„Ù…ÙØ¶Ù„ Ù„ÙŠÙƒ Ø¹Ù„ÙŠÙ‡Ø§ØŸ", "Ø­Ø±ÙƒØ© Ø¨ØªØ¹Ù…Ù„Ù‡Ø§ Ø¨ØªØ®Ù„ÙŠÙƒ ØªØªØ¬Ù†Ù†ØŸ"],
                    female: ["Ø¨ØªØ­Ø¨ÙŠ ØµÙˆØªÙ‡ ÙŠÙƒÙˆÙ† Ù‡Ø§Ø¯ÙŠ ÙˆÙ„Ø§ Ù…Ø³ÙŠØ·Ø±ØŸ", "Ø¥ÙŠÙ‡ Ø£ÙƒØªØ± Ù„Ù…Ø³Ø© Ù…Ù†Ù‡ Ø¨ØªØ®Ù„ÙŠ Ø¬Ø³Ù…Ùƒ ÙŠÙ‚Ø´Ø¹Ø±ØŸ", "Ø¨ØªØ­Ø¨ÙŠ ØªØ´ÙˆÙÙŠÙ‡ Ø¨Ù‚Ù…ÙŠØµ ÙˆÙ„Ø§ ØªÙŠØ´Ø±ØªØŸ", "ØªÙˆØµÙÙŠ Ø±ÙŠØ­ØªÙ‡ Ø¨Ø¥ÙŠÙ‡ØŸ"]
                },
                dare: {
                    male: ["Ù‚Ù„Ø¹Ù‡Ø§ Ø§Ù„Ø´Ø±Ø§Ø¨ ÙˆØ§Ø¹Ù…Ù„ Ù…Ø³Ø§Ø¬ Ù„Ø±Ø¬Ù„ÙŠÙ‡Ø§.", "Ø¨ÙˆØ³Ø© Ø·ÙˆÙŠÙ„Ø© (French Kiss).", "ÙÙƒ Ø²Ø±Ø§ÙŠØ± Ø¨Ù„ÙˆØ²ØªÙ‡Ø§ Ø¨Ø¨Ø·Ø¡.", "Ù…Ø³Ø§Ø¬ Ù„Ø¶Ù‡Ø±Ù‡Ø§ Ø¨Ø²ÙŠØª.", "Ø´ÙŠÙ„Ù‡Ø§ ÙˆØ¯Ø®Ù„Ù‡Ø§ Ø§Ù„Ø£ÙˆØ¶Ø©."],
                    female: ["Ù‚Ù„Ø¹ÙŠÙ„Ù‡ Ø§Ù„Ù‚Ù…ÙŠØµ/Ø§Ù„ØªÙŠØ´Ø±Øª.", "Ø¹Ø¶ÙŠÙ‡ ÙÙŠ ÙƒØªÙÙ‡.", "Ø§Ù…Ø´ÙŠ Ù‚Ø¯Ø§Ù…Ù‡ Ù…Ø´ÙŠØ© 'Catwalk'.", "Ø¨ÙˆØ³Ø© ÙˆØ±Ø§ ÙˆØ¯Ù†Ù‡.", "Ø³ÙŠØ¨ÙŠ Ø´Ø¹Ø±Ùƒ ÙˆÙˆØ·ÙŠ Ø¹Ù„ÙŠÙ‡."]
                }
            },
            lvl3: {
                truth: {
                    male: ["Ù†ÙØ³Ùƒ ØªØ±Ø¨Ø·Ù‡Ø§ ÙˆÙ„Ø§ Ù‡ÙŠ ØªØ±Ø¨Ø·ÙƒØŸ", "Ø¥ÙŠÙ‡ Ø£ÙƒØªØ± ÙˆØ¶Ø¹ Ø¨ÙŠØ­Ø³Ø³Ùƒ Ø¨Ù…Ù„ÙƒÙŠØªÙƒ Ù„ÙŠÙ‡Ø§ØŸ", "ØªØªØ®ÙŠÙ„Ù‡Ø§ Ø¨Ø²ÙŠ ØªÙ†ÙƒØ±ÙŠ Ø¥ÙŠÙ‡ØŸ", "Ø¨ØªØ­Ø¨ ØªØ³Ù…Ø¹ ØµÙˆØªÙ‡Ø§ Ø¥Ø²Ø§ÙŠ ÙˆÙ‚Øª Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©ØŸ"],
                    female: ["Ø¨ØªØ­Ø¨ÙŠ Ø§Ù„Ø®Ø¶ÙˆØ¹ ÙˆÙ„Ø§ Ø§Ù„Ø³ÙŠØ·Ø±Ø© Ø£ÙƒØªØ±ØŸ", "Ø¥Ø­Ø³Ø§Ø³Ùƒ Ø¥ÙŠÙ‡ Ù„Ù…Ø§ Ø¨ÙŠÙ…Ø³Ùƒ Ø±Ù‚Ø¨ØªÙƒØŸ", "Ù†ÙØ³Ùƒ ÙŠØ¹Ù…Ù„ ÙÙŠÙƒÙŠ Ø¥ÙŠÙ‡ Ø¯Ù„ÙˆÙ‚ØªÙŠØŸ", "Ø¥ÙŠÙ‡ Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù„ÙŠ Ù„Ùˆ Ù‚Ø§Ù„Ù‡Ø§ Ø¨ØªØ¯ÙˆØ®ÙŠØŸ"]
                },
                dare: {
                    male: ["Ø£Ù…Ø± Ø¨Ø§Ù„Ø®Ø¶ÙˆØ¹: Ø®Ù„ÙŠÙ‡Ø§ ØªØ±ÙƒØ¹ ÙˆØªÙ†ÙØ° Ø£Ù…Ø±Ùƒ.", "Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ø§Ø© (Ø±ÙŠØ´Ø©/ØªÙ„Ø¬) Ø¹Ù„Ù‰ Ø¬Ø³Ù…Ù‡Ø§.", "Ø³ÙŠØ·Ø± Ø¹Ù„Ù‰ Ø­Ø±ÙƒØªÙ‡Ø§ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ 5 Ø¯Ù‚Ø§ÙŠÙ‚.", "ÙˆØ¶Ø¹ Ø§Ù„ÙØ±Ø§Ø´Ø©.", "ØºÙ…ÙŠ Ø¹ÙŠÙ†Ù‡Ø§."],
                    female: ["Ø§Ø³ØªØ³Ù„Ø§Ù… ØªØ§Ù… Ù„Ù„Ù…Ø³Ø§ØªÙ‡.", "Ø§Ø¹Ù…Ù„ÙŠ ÙˆØ¶Ø¹ Ù‡Ùˆ ÙŠØ®ØªØ§Ø±Ù‡ Ø­Ø§Ù„Ø§.", "Ø¯Ù„Ø¹ÙŠÙ‡ Ø¨Ù„Ø³Ø§Ù†Ùƒ ÙÙŠ Ù…Ù†Ø·Ù‚Ø© Ù‡Ùˆ ÙŠØ®ØªØ§Ø±Ù‡Ø§.", "Ù‚ÙˆÙ„ÙŠÙ„Ù‡ 'ÙŠØ§ Ø³ÙŠØ¯ÙŠ' Ø·ÙˆÙ„ Ø§Ù„Ø¬ÙˆÙ„Ø©.", "Ø§Ø±Ù‚ØµÙŠ Ù„ÙŠÙ‡."]
                }
            },
            dice: { // Shared actions mostly
                actions: ["Ø¨ÙˆØ³", "Ø§Ù„Ù…Ø³", "Ø¹Ø¶", "Ø§Ù„Ø­Ø³", "Ø§Ù†ÙØ®", "Ø§Ø¹ØµØ±", "Ø¯Ù„Ùƒ", "Ø´Ù…", "Ù‚Ø±Øµ"],
                parts: ["Ø§Ù„Ø±Ù‚Ø¨Ø©", "Ø§Ù„Ø´ÙØ§ÙŠÙ", "Ø§Ù„ÙØ®Ø°", "Ø§Ù„ÙˆØ¯Ù†", "Ø§Ù„ØµØ¯Ø±", "Ø§Ù„Ø¶Ù‡Ø±", "Ø§Ù„Ø¥ÙŠØ¯", "Ø§Ù„Ø±Ø¬Ù„", "Ø§Ù„Ø³Ø±Ø©"]
            }
        };

        // --- STATE ---
        let state = {
            safeMode: false,
            score1: 0, // Ahmed
            score2: 0, // Lulu
            currentLevel: 1,
            currentPlayer: 1, // 1 = Ahmed (Male), 2 = Lulu (Female)
            pendingPoints: 0 // Points waiting for confirmation
        };

        // --- CORE FUNCTIONS ---
        function toggleMode() {
            state.safeMode = document.getElementById('modeToggle').checked;
            updateUIForMode();
        }

        function updateUIForMode() {
            document.getElementById('lvl2-btn').style.display = state.safeMode ? 'none' : 'block';
            document.getElementById('lvl3-btn').style.display = state.safeMode ? 'none' : 'block';
            if(state.safeMode && state.currentLevel > 1) setLevel(1);
        }

        function switchTab(tabId, btn) {
            document.querySelectorAll('.module').forEach(m => m.classList.remove('active'));
            document.getElementById('mod-' + tabId).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            resetActions(); // Hide confirm buttons when switching
        }

        function resetActions() {
            document.querySelectorAll('.confirm-area').forEach(el => el.style.display = 'none');
            document.getElementById('card-draw-btns').style.display = 'flex';
            document.getElementById('spin-btn').style.display = 'block';
            document.getElementById('dice-btn').style.display = 'block';
            document.getElementById('joker-btn').style.display = 'block';
            document.getElementById('wheel-result').innerText = "Ø¬Ø§Ù‡Ø²ÙŠÙ†ØŸ";
            document.getElementById('card-text').innerText = "Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒØ§Ø±Øª";
        }

        // --- TURNS & SCORING ---
        function confirmAction(isDone, points) {
            // Hide buttons
            document.querySelectorAll('.confirm-area').forEach(el => el.style.display = 'none');
            
            // Restore main buttons
            document.getElementById('card-draw-btns').style.display = 'flex';
            document.getElementById('spin-btn').style.display = 'block';
            document.getElementById('dice-btn').style.display = 'block';
            document.getElementById('joker-btn').style.display = 'block';

            if (isDone) {
                // If points passed as string 'card', calculate based on level
                let pts = points;
                if (points === 'card') {
                    pts = state.currentLevel === 1 ? 15 : (state.currentLevel === 2 ? 30 : 50);
                }
                
                // Add Score
                let player = state.currentPlayer;
                state['score' + player] += pts;
                let scoreEl = document.getElementById('score' + player);
                scoreEl.innerText = state['score' + player];
                scoreEl.style.transform = "scale(1.3)";
                setTimeout(()=> scoreEl.style.transform = "scale(1)", 200);
                
                checkUnlocks();
            }

            // Always Switch Turn
            state.currentPlayer = state.currentPlayer === 1 ? 2 : 1;
            updateTurnUI();
            
            // Reset Texts
            document.getElementById('wheel-result').innerText = "Ø¬Ø§Ù‡Ø²ÙŠÙ†ØŸ";
            document.getElementById('card-text').innerText = "Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒØ§Ø±Øª";
        }

        function updateTurnUI() {
            document.getElementById('box-p1').classList.remove('active-turn');
            document.getElementById('box-p2').classList.remove('active-turn');
            document.getElementById('box-p' + state.currentPlayer).classList.add('active-turn');
            
            let name = state.currentPlayer === 1 ? "Ø£Ø­Ù…Ø¯" : "Ù„ÙˆÙ„Ùˆ";
            document.querySelectorAll('.cp-name').forEach(el => el.innerText = name);
        }

        function checkUnlocks() {
            let total = state.score1 + state.score2;
            let msg = document.getElementById('reward-msg');
            if (!state.safeMode) {
                if (total >= 50) document.getElementById('lvl2-btn').classList.remove('locked');
                if (total >= 150) {
                    document.getElementById('lvl3-btn').classList.remove('locked');
                    msg.innerText = "ğŸ† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¹Ù…ÙŠÙ‚ Ù…ÙØªÙˆØ­!";
                }
            }
        }

        // --- WHEEL ---
        function spinWheel() {
            let btn = document.getElementById('spin-btn');
            btn.style.display = 'none'; // Hide spin button
            
            // Get Gender Specific Data
            let genderKey = state.currentPlayer === 1 ? 'male' : 'female';
            let pool = data.wheel[genderKey];
            if (state.safeMode) pool = pool.filter(i => i.safe);
            
            let selected = pool[Math.floor(Math.random() * pool.length)];
            
            let wheel = document.getElementById('wheel');
            let randomDeg = Math.floor(1000 + Math.random() * 2000); 
            wheel.style.transform = `rotate(${currentRotation + randomDeg}deg)`;
            currentRotation += randomDeg;

            setTimeout(() => {
                document.getElementById('wheel-result').innerText = selected.t;
                // Show confirm buttons
                document.getElementById('wheel-actions').style.display = 'flex';
            }, 4000);
        }
        let currentRotation = 0;

        // --- CARDS ---
        function setLevel(lvl) {
            let btn = document.getElementById('lvl' + lvl + '-btn');
            if (btn.classList.contains('locked') && !state.safeMode) {
                alert("ğŸ”’ Ù„Ø³Ù‡ Ø¨Ø¯Ø±ÙŠ! Ø¬Ù…Ø¹ÙˆØ§ Ù†Ù‚Ø§Ø· Ø£ÙƒØªØ±.");
                return;
            }
            state.currentLevel = lvl;
            document.querySelectorAll('.lvl-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function drawCard(type) {
            let lvlKey = 'lvl' + state.currentLevel;
            let genderKey = state.currentPlayer === 1 ? 'male' : 'female';
            
            // Safe Mode Logic: Block Dare in Lvl 2/3 if Safe Mode (Already handled by UI hiding levels)
            // But let's be safe:
            let pool = data[lvlKey][type][genderKey];
            
            let card = pool[Math.floor(Math.random() * pool.length)];
            
            document.getElementById('card-draw-btns').style.display = 'none'; // Hide draw buttons
            document.getElementById('joker-btn').style.display = 'none';
            
            let textDiv = document.getElementById('card-text');
            textDiv.innerText = card;
            
            // Update potential points display
            let pts = state.currentLevel === 1 ? 15 : (state.currentLevel === 2 ? 30 : 50);
            document.getElementById('pts-val').innerText = pts;

            // Show Confirm
            document.getElementById('card-actions').style.display = 'flex';
        }

        function useJoker() {
             document.getElementById('card-text').innerText = "ğŸƒ Ø§Ù„Ø¬ÙˆÙƒØ±! \n ØªÙ… Ø§Ù„Ø¹ÙÙˆ. Ø¨ÙˆØ³Ø© ÙˆØ§Ù†ØªÙ‚Ù„ Ù„Ù„Ø¯ÙˆØ± Ø§Ù„ØªØ§Ù„ÙŠ.";
             // Auto skip without points or penalty, just visual
        }

        // --- DICE ---
        function rollDice() {
            let btn = document.getElementById('dice-btn');
            btn.style.display = 'none';
            
            let dieA = document.getElementById('die-action');
            let dieB = document.getElementById('die-body');
            dieA.classList.add('shake'); dieB.classList.add('shake');
            
            setTimeout(() => {
                dieA.classList.remove('shake'); dieB.classList.remove('shake');
                
                let actions = data.dice.actions;
                let parts = data.dice.parts;
                
                // Safe Mode Filtering
                if (state.safeMode) {
                    actions = actions.filter(a => !["Ø¹Ø¶", "Ø§Ù„Ø­Ø³", "Ø§Ø¹ØµØ±"].some(b=>a.includes(b)));
                    parts = parts.filter(p => !["Ø§Ù„ÙØ®Ø°", "Ø§Ù„ØµØ¯Ø±", "Ø§Ù„Ù…Ø¤Ø®Ø±Ø©"].some(b=>p.includes(b)));
                }

                dieA.innerText = actions[Math.floor(Math.random() * actions.length)];
                dieB.innerText = parts[Math.floor(Math.random() * parts.length)];
                
                document.getElementById('dice-actions').style.display = 'flex';
            }, 500);
        }

        function openHelp() { document.getElementById('helpModal').style.display = 'flex'; }
        function closeHelp() { document.getElementById('helpModal').style.display = 'none'; }
        
        // Init
        updateUIForMode();
        updateTurnUI();

        if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js'); }
    </script>
</body>
</html>
